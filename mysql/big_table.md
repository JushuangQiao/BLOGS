> 前提：由于业务需要，需要每一天扫描一个千万行的 MySQL 数据表，并用获取到的数据做一些事情，怎么能尽快的完成表的扫描呢？

-
一个思路：使用了批量 + 并发 + 异步的方法。
>
1. 首先获取到表中数据最大的 ID 和最小的 ID，并且设置一个阈值，例如 1000；
2. 建立一个异步批量分发函数，传入最大和最小的 ID；
3. 如果传入的最大和最小的 ID 的差值不大于阈值，则直接去调用异步任务的执行函数去完成 ID 段之间的扫描；
4. 如果大于阈值，则调用一个普通的分发函数，传入最大和最小的 ID，当两个 ID 之差小于阈值，继续异步调用批量分发函数；
5. 重复执行 3、4，直到分发完成。

思路解释：
>
1. 获取数据库的自增 ID，由于 ID 上会有聚簇索引，所以获取两个 ID 之间的数据会非常快；
2. 使用异步分发，可以保证某个数据段执行有问题的时候，不会影响到别的数据段的数据执行；
3. 使用并发，可以保证要执行的数据最快的执行完成，充分利用机器资源。